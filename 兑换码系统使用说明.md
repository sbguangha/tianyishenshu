# 🎫 兑换码系统使用说明

## 📋 系统概述

兑换码系统是天乙神数应用的核心功能之一，用于管理客户访问权限。系统包含：
- **管理员后台**：生成和管理兑换码
- **用户登录**：使用兑换码进行身份验证

## 🔧 功能特性

### ✨ **管理员功能**
- 🔐 密码验证登录
- 🎫 一键生成16位兑换码
- 📊 实时统计数据
- 📋 兑换码列表管理
- 🗑️ 删除未使用的兑换码
- 📱 一键复制兑换码

### 👤 **用户功能**
- 📱 手机验证码登录
- 🎫 兑换码实时验证
- 📋 一键粘贴兑换码
- 💾 记住登录状态

## 🚀 快速开始

### **1. 启动系统**
```bash
# 启动后端服务
cd backend
npm run dev

# 启动前端服务
cd frontend  
npm run dev
```

### **2. 管理员访问**
- 访问地址：`http://localhost:5175/admin-panel-2024`
- 默认密码：`tianyi2024`

### **3. 用户登录**
- 访问地址：`http://localhost:5175/login`
- 需要：手机号 + 验证码 + 兑换码

## 📖 详细使用流程

### 🔐 **管理员操作流程**

#### **步骤1：登录管理系统**
1. 访问 `http://localhost:5175/admin-panel-2024`
2. 输入管理员密码：`tianyi2024`
3. 点击"登录管理系统"

#### **步骤2：生成兑换码**
1. 点击"🎫 生成新兑换码"按钮
2. 系统自动生成16位兑换码
3. 点击📋图标复制兑换码
4. 通过微信发送给客户

#### **步骤3：管理兑换码**
- **查看统计**：总数量、待使用、已使用、已过期
- **筛选状态**：全部/待使用/已使用/已过期
- **删除兑换码**：仅限未使用的兑换码
- **查看使用记录**：用户手机号、使用时间

### 👤 **客户使用流程**

#### **步骤1：获取兑换码**
- 联系客服微信获取16位兑换码
- 格式示例：`2406AB8F9E2D4C7K`

#### **步骤2：登录验证**
1. 访问 `http://localhost:5175/login`
2. 输入手机号码
3. 点击"发送验证码"
4. 输入6位短信验证码
5. 输入16位兑换码（支持粘贴）
6. 点击"步入玄境"完成登录

## 🎨 兑换码格式说明

### **生成规则**
- **总长度**：16位
- **格式**：年月日(6位) + 随机字符(10位)
- **字符集**：A-Z, 0-9
- **示例**：`2406AB8F9E2D4C7K`
  - `2406`：2024年6月
  - `AB8F9E2D4C7K`：随机字符

### **验证规则**
- 必须是16位字符
- 只能包含大写字母和数字
- 必须是有效且未使用的兑换码

## 🔧 技术配置

### **管理员密码修改**
```javascript
// backend/src/routes/admin.ts
const ADMIN_PASSWORD = process.env.ADMIN_PASSWORD || 'tianyi2024'
```

### **访问路径修改**
```javascript
// frontend/src/App.tsx
<Route path="/admin-panel-2024" element={<Admin />} />
```

### **API端点**
```
POST /api/admin/auth              - 管理员验证
POST /api/admin/generate-code     - 生成兑换码
GET  /api/admin/codes             - 获取兑换码列表
DELETE /api/admin/codes/:id       - 删除兑换码

POST /api/auth/validate-exchange-code - 验证兑换码
POST /api/auth/verify-login           - 登录验证
```

## 📊 数据统计

### **实时统计指标**
- **总数量**：所有兑换码总数
- **待使用**：未使用的兑换码数量
- **已使用**：已被客户使用的数量
- **已过期**：过期的兑换码数量

### **使用记录**
- 兑换码使用者手机号
- 使用时间戳
- 创建时间和创建者

## 🛡️ 安全特性

### **权限控制**
- 管理员密码验证
- Token-based认证
- 隐蔽的管理页面路径

### **数据验证**
- 手机号格式验证
- 兑换码格式验证
- 重复使用防护

### **错误处理**
- 友好的错误提示
- 网络异常处理
- 输入格式纠错

## 🎯 最佳实践

### **管理员操作建议**
1. **定期检查**：查看兑换码使用情况
2. **及时清理**：删除过期或无效的兑换码
3. **记录管理**：保留重要的使用记录
4. **密码安全**：定期更换管理员密码

### **客户服务建议**
1. **清晰说明**：向客户说明兑换码使用方法
2. **及时响应**：快速处理兑换码相关问题
3. **格式提醒**：提醒客户兑换码格式要求
4. **使用指导**：提供详细的登录步骤

## 🔄 系统维护

### **日常维护**
- 监控兑换码使用情况
- 清理过期的兑换码
- 备份重要数据

### **故障排除**
- 检查服务器运行状态
- 验证API接口连通性
- 查看错误日志

## 📞 技术支持

如遇到技术问题，请检查：
1. 服务器是否正常运行
2. 网络连接是否正常
3. 浏览器控制台错误信息
4. API接口响应状态

---

**🎉 兑换码系统已成功部署并测试通过！**

系统特点：
- ✅ 16位安全兑换码
- ✅ 实时验证和状态管理
- ✅ 友好的管理界面
- ✅ 完整的使用流程
- ✅ 安全的权限控制 